离散数学 2 - 关系
笔记 | 数学 | 计算机 | 离散数学
离散数学（Discrete mathematics）是数学的几个分支的总称，研究基于离散空间而不是连续的数学结构。与连续变化的实数不同，离散数学的研究对象——例如整数、图和数学逻辑中的命题——不是连续变化的，而是拥有不等、分立的值。因此离散数学不包含微积分和分析等“连续数学”的内容。离散对象经常可以用整数来枚举。
2018-10-8





[上一篇：离散数学 1 - 映射](blog.php?id=4)

[下一篇：离散数学 3 - 近世代数](blog.php?id=21)

## 置换

有限集合到其自身的一一对应（双射）就称为该集合的一个置换，$n$  个元素的集合上的置换，称为 $n$ 阶置换。$\sigma(i) = k_i$ 或者：

$$
\sigma = 
\begin{pmatrix}
1 & 2 & 3 & \ldots & n\\
k_1 & k_2 & k_3 & \ldots & k_n
\end{pmatrix}
$$

#### 特征函数的定义

设 $X$ 是一个集合，$E \subseteq X$，$X$ 到 $\{0, 1\}$ 的一个如下映射 $\chi_e$ ，称为集合 $E$ 上的一个特征函数，$\forall x \in X$：

$$
\chi_e(x) = 
\begin{cases}
1 & 如果 x \in E \\
0 & x \not \in E，即 x = X \backslash E
\end{cases}
$$

显然集合 $E$ 的特征函数 $\chi_e$ 由 $E$ 唯一确定。于是 $E, F \subseteq X$，但是 $E \neq F$，则 $\chi_F \neq \chi_E$。令 $Ch(X) = \{\chi | \chi: X \to \{0, 1\}\}$，$\Phi: 2^X \to Ch(X)$，$\forall E \in 2^X$，$\Phi(E) = \chi_E$，则 $\Phi$ 是 $2^X$ 到 $Ch(X)$ 的一个单射，又若 $\chi \in Ch(X)$，令：

$$
F = \{X | \chi(X) = 1, x \in X\}
$$

则 $\chi_F = \chi$，于是，$\Phi$ 是从 $2^X$ 到 $Ch(X)$ 间的一个一一对应。


## 关系

#### 关系的定义

设 $A, B$ 是两个集合，一个从 $A \times B$ 到集合 {是，否}，的映射 $R$ 称为一个从 $A$ 到 $B$ 的一个二元关系。如果 $A \times B$ 中的元 $(a, b)$ 在 $R$ 下的象为「是」，则称 $a$ 与 $b$ 复合关系 $R$，记成 $aRb$。如果 $(a, b)$ 在 $R$ 下的象为「否」，则称 $a$ 与 $b$ 不符合关系 $R$，记为 $a \not R b$。如果 $A = B$ ，则称 $R$ 为 $A$ 上的二元关系。

##### 例 1：

设 $Z$ 表示整数之集，整数间的整除关系 | ：$m | n \iff m$ 能整除 $n, m, n \in Z$ 就是 $Z$ 上的一个二元关系。

##### 例 2：

整数集 $Z$ 上的模 $n$ 同余关系 「$\equiv$」 是 $Z$ 上的如下的二元关系：$\forall m, k \in Z$：
$$
m \equiv k \pmod n \iff n | (m - k)
$$

##### 例 3：

令 $M_n$ 为复数域 $C$ 上的 $n \times n$ 矩阵的全体所形成的集合。$M_n$ 上的二元关系 ~：$\forall A, B \in M_n$，
$$
A \sim B \iff \exists P \in M_n，使 A = P^{-1}BP
$$
这就是 $n$ 阶方阵间的相似关系。

##### 例 4：

映射 $f$ 则是一个特殊的二元关系，即存在 $x$ ，则有唯一的 $y$ 使得 $xfy$，而任一一般的二元关系，未必存在 $x$，而这里的 $y$ 也未必唯一。

#### 关系的第二种定义

`这是关系最常用的定义方式`，设 $A$ 与 $B$ 是两个集合，$A \times B$  的任一子集 $R$ 称为 $A$ 到 $B$ 的一个二元关系，如果 $(a, b) \in R$，则称 $a$ 与 $b$ 符合关系 $R$，记成 $aRb$，如果 $(a, b) \not \in R$，则说 $a$ 与 $b$ 不符合关系 $R$.

##### 定义域与值域

$x$ 的域为定义域，记为 $dom(R)$，$y$ 的域为值域，记为 $Ran(R)$



##### 定义

设 $A, B$ 是两个集合，一个从 $A$ 到 $2^B$ 的映射 $R$ 称为一个从 $A$ 到 $B$ 的多值部分映射。如果 $a \in A, R(a) = \phi$，那么我们称 $R$ 在 $a$ 出无定义；反之为「象」或者「值」

设 $R$ 是从 $A$ 到 $B$ 的一个二元关系，利用 $R$ 的构造一个 $A$ 到 $2^B$ 的映射 $f_R: \forall x \in A$

$$
f_R = 
\begin{cases}
&\phi&如果 \forall y \in B, (x, y) \not \in R \\
&\{y | y \in B, (x, y) \in R\} &否则
\end{cases}
$$

记号：$B^A = \{f | f: A \to B\}$

##### 定理

从 $A$ 到 $B$ 的所有二元关系的集合 $2^{A \times B}$  与从 $A$ 到 $2^B$ 的所有映射的集合 $(2^B)^A$ 是对等的（证明映射相同，只需证明 $\forall x, f(x) = g(x)$）。

#### 关系的第三种定义

设 $A$ 和 $B$ 是两个集合，一个从  $A$ 到 $B$ 的多值部分映射 $R$，称为一个从  $A$ 到 $B$ 的所有二元关系的。如果 $x \in A, y \in R(x)$，则称 $x$ 与 $y$ 符合关系 $R$，反之不符合。

> 二元关系就是函数概念的推广，从单值性推广到多值性，从处处有定义推广到对部分元素有定义。
>
> 以上，详细地讨论了二元关系的三证形式定义。它们都是等价的，在数学中，特别是在计算机科学的各个领域中，这三种定义均有人使用。甚至还有人使用另外的等价定义，不过最多的定义是 2 与 3。

##### 程序调用关系

设 $M$ 是一个主程序及各程序段（即函数过程和子程序过程）所形成的的集合，程序段间的「直接调用关系」$R$，可用列出 $R$ 中所有元素对来表示。例，如果：
$$
M = \{S_主，F_1，F_2，SUB_1，SUB_2\}
$$
则：

$$
R = \{(S_主, F_1),(S_主, F_2), (F_2, F_3), (F_3, SUB_1), (SUB_1, SUB_2)\}
$$

就是 $M$ 上的一个二元关系程序段间的直接调用关系。

##### 关系的域

设 $A_1, A_2, \ldots A_n$ 是 $n$ 个集合，集合 $A_1 \times A_2 \times \ldots \times A_n$ 的任何一个子集 $R$ 称为 $A_1, A_2 , \ldots A_n$ 间的一个 $n$ 元关系。每个集合 $A_i$ 称为 $R$ 的一个域。

在数据库中，把 $n$ 元关系看成一个二维的表，表的每一行对应一个 $R$ 中的 $n$ 元组，表中每一列起一个名字，称为 $R$ 的一个属性，于是，$n$ 元关系就有 $n$ 个属性。

### 关系的性质

##### 恒等关系

设 $X$ 是一个集合，$X \times X$ 的子集，$I_X$
$$
I_x = \{(x, x) | x \in X\}
$$
称为 $X$ 上的恒等关系。在不发生误会的情况下，$X$ 上的恒等关系 $I_x$ 记为 $I$。

##### 自反的关系

设 $R$ 是集合 $X$ 上的一个二元关系，如果 $\forall x \in X$，$xRx$，则称 $R$ 是自反的。

$X$ 上的而关系 $R$ 是自反的当且仅当 $I_x \subseteq R$

##### 反自反的关系

集合 $X$ 上的二元关系 $R$ 称为反自反的，如果 $\forall x \in X$，$x$ 与 $x$ 不符合关系 $R$

比如「父子」关系是反自反的，实数间「小于」关系是反自反的。

##### 对称关系

集合 $X$ 上的二元关系 $R$ 称为是对称的，如果对 $X$ 中任两个元素 $x, y$ 只要 $xRy$，则必有 $yRx$。

##### 关系的逆

对任一 $A$ 到 $B$ 的二元关系 $S$，伴随这一个 $B$ 到 $A$ 的二元关系，称为 $S$ 的逆关系，用 $S^{-1}$ 表示其定义为
$$
S^{-1} = \{(y, x)|(x, y) \in S\}
$$

集合解释：一个关系的逆是原来的关系以主对角线为对称轴进行翻转获得到的集合。

##### 例：

设映射 $f$，则 $Ker(f)$ 是 $X$ 上的一个二元关系。其中：
$$
Ker(f) = \{(x, y) | x, y, \in X 并且 f(x) = f(y)\}
$$

这个二元关系是自反和对称的。

##### 反对称

集合 $X$ 上的二元关系 $R$ 称为反对称的，如果 $xRy$，且 $yRx$ 则 $x = y$。

意思为，只要 $x \neq y$，则 $xRy$ 和 $yRx$ 就不能同时存在。

- 整数集上的「整除」关系，实数集上的「小于等于」关系，集合间的「包含」关系是反对称的。
- 恒等关系既是对称的又是反对称的，但反之非真，集合 $X$ 上的关系 R 既是对称的又是反对称的，当且仅当 $R \subseteq I_x$.

##### 关系的传递

如果 $xRy$，$yRz$，则 $xRz$ 则这个二元关系具有传递性

- 定义在人的集合上的「朋友」关系，「相互认识」关系均不是传递关系，集合间的包含关系是传递的
- $R$ 反自反且对称，$R$ 不传递除非 $R$ 是空关系
  - 证明：因为对称，$(a, b) \in R$，$(b, a) \in R$，$\Rightarrow (a, a) \in R$ ，所以自反，矛盾

##### 相容的关系

自反又对称则为相容（比如定义在人的集合上「朋友」，「相互认识」均是相容的）

##### 例： 

$X$ 上的二元关系 $R$ 是对称的，当且仅当 $R = R^{-1}$

证明：

$\Rightarrow R \in x^2$，证明：彼此互为子集

$\Leftarrow$ 有 $(x, y) \in R$，必有 $(y, x) \in R^{-1}$

### 关系的合成

#### 关系的合成定义

$R \circ S = \{(x, z) | (x, z) \in A \times C 且 \exists y \in B, 使 xRy, ySz\}$

##### 关系的合成满足结合律

证明：

$$
xRy, ySz \Rightarrow x(R\circ S)z\\
x(R \circ S)z \Rightarrow \exists y, xRy, ySz
$$

合成的分配率：

$$
R_1 \circ (R_2 \cup R_3) = (R_1 \circ R_2) \cup (R_1 \circ R_3) \\
R_1 \circ (R_2 \cap R_3) = (R_1 \circ R_2) \cap (R_1 \circ R_3)
$$

定理：$R, S$ 为 $X$ 上的二元关系，则：

- $(R \circ S)^{-1} = S^{-1} \circ R^{-1}$
- $R \circ R^{-1}$ 是对称的

##### 关系传递的充分必要条件

传递，当且仅当 $R^2 \subseteq R$

##### 关系的幂的定义

设 $R$ 是二元关系，递归定义 $R$  的非负整数次幂如下：
$$
R^0 = I_x, \; R^1 = R,\; R^{n + 1} = R^n \circ R
$$



##### 定理

设 $R$，对任意 $n, m$，有：
$$
R^{m +n} = R^m \circ R^n，(R^m)^n = R^{mn}
$$

作业，留作证明：$R \circ I_x = R$

##### 定理

$R$ 是对称且对称且传递，当且仅当 $R = R \circ R^{-1}$

### 关系的闭包

设 $P$ 是关系的某些性质的集合，一个关系 $R$ 的 $P - 闭包$ 就是包含 $R$ 且具有 $P$ 中所有性质的所有关系的交。

设 $R$ 在 $X$ 上，$X$ 上的一切包含 $R$ 的传递关系的交称为 $R$ 的传递闭包，用 $R^+$ 表示，即：

$$
R^+ = \bigcap_{R \subseteq R'，R' 是传递的} R' （R \subseteq R^+ \subseteq R'）
$$

$R^+$ 就是包含 $R$ 的那些传递中最小的那个

##### 定理

关系的传递闭包是传递关系

##### 定理

$R$ 是 $X$ 上的二元关系，则：
$$
R^+ = \bigcup_{n = 1}^{\infty}R^n
$$

证明：彼此互为子集：

1. 前者是子集

`思考`：
$$
R^+ = \bigcup_{n = 1}^{\infty }R^n \cap R' \Rightarrow R^+ \subseteq \bigcup_{n = 1}^{\infty }R^n （只需证明，后者具有传递性即可）
$$
概要：$(x, y) \in R^{n_0}$，$(y, z) \in R_{n_1}$，则 $(x, z) \in R^{n_0 +n_1}$

2. 后者是子集

概要：$(x, y) \in R^n$，$(x, x_1), (x_1, x_2) \ldots (x_n - 1, y) \in R$，$R \subseteq R^+$，$R^+$ 具有传递性可证。

##### 定理

关系 R，则 $R^+ = R \cup R^2 \cup \ldots \cup R^n$，此时 $n$  是有限的
$$
R \cup R^2 \cup \ldots \cup R^n \subseteq \bigcup_{n = 1}^{\infty}R^n = R^+
$$

只需证明 $R^{n + k} \subseteq R \cup R^2 \cup \ldots \cup R^n$，则 $\bigcup_{n = 1}^{\infty}R^n \subseteq R^n$，$k > 1$

$$
(x, x_1), (x_1, x_2), \ldots, (x_{n + k - 1}, y) \in R\\
|x| = n\\
x, x_1, x_2, \ldots, x_{n + k - 1} 个元素，由抽屉原理知，至少有两个元素相等\\
则 \exists i, j， i < j, 1 \le i, j \le n + k - 1\\
s.t. \quad x_i = x_j\\
则能压缩成 (x, x_1) \ldots (x_{i - 1}, x_i),(x_i, x_j + 1) \ldots (x_{n + k - 1}, y)
使得 (x, y) \in R^{n + k -  1 - j - i} \subseteq R^1 \cup R^2 \ldots R^n
$$

##### 定理

- $\phi^+ = \phi$
- $R \subseteq R^+$
- $(R^+)^+ = R^+$
- $(R \cup S)^+ = R^+ \cup S^+$

自反传递闭包定义，类似于传递闭包。

##### 定理

$R$ 二元关系，则：
$$
R^* = R^0 \cup R^+  = I_x \cup R^+ \\
即：I_x \cup R^+ = \bigcap_{...}R' = R*
$$

##### 例：

设 $X$ 是人的集合，$R$ 是父子关系，则 $xR^+y$ 当且仅当 $y$ 是 $x$ 的后代，于是 $R^+$ 就是后代关系

<u>**例 2**</u>：$N$ 是自然数，$aRb \iff a + 1 = b$，$R^+$ 就是东已在 $N$ 上的通常的 $<$ 关系

### 关系矩阵和关系图

#### 关系矩阵

##### 关系矩阵定义

定义矩阵：

$$
b_{ij} = 
\begin{cases}
&1，&如果 x_iRy_i \\
&0，&否则
\end{cases}
$$

为关系矩阵。

##### 定理：

- 自反，则对角线为 $1$
- 反自反，对角线为 $0$
- 对称，矩阵对称
- 反对称，如果 $i \neq j$，则 $b_{ij} = b_{ji}$ 不能同时为 $1$
- 传递，则 $b_{ij} = 1, b_{j, k} = 1$，则 $b_{i, k} = 1$
- $R^{-1}$ 的矩阵为 $B^T$

关系矩阵是一个布尔矩阵，定义两个矩阵的逻辑，$B \lor C = b_{ij} \lor c_{ij}$，逻辑且 $\land$ 同样如此定义。



定义一种布尔乘法运算 $\circ$：

$$
B \circ C = D \\
d_{ij} = \bigvee_{k = 1}^{p}(b_{ik} \land c_{kj})
$$

##### 定理：

- 逻辑或和且满足交换律
- 逻辑或、且，布尔乘法都满足结合律
- 布尔乘法对于逻辑或（且）满足分配率

##### 定理

设 $R, S$ 是 $X$ 到 $Y$ 的二元关系，其矩阵 $B_R$ 和 $B_S$，$R \cup S$ 与 $R \cap S$ 的矩阵分别为 $B_{R \cup S}$，$B_{R \cap S}$，则：

$$
B_{R \cup S} = B_{R} \land B_{S}\\
B_{R \cap S} = B_{R} \lor B_{S}\\
$$

#### 关系图

$(x ,y) \in R$ 表示为 $x \to y$ 的一条有向线段。

### 等价关系与集合的划分

$R$ 为等价关系 $\iff$

- 自反性
- 对称性
- 传递性

通常用 $\cong$ 表示全等关系

##### 例 1：

集合 $X$ 上的恒等关系（$I_x$）是等价关系

##### 例 2：

整数集合 $Z$ 上的膜 $n$ 同余是等价关系

##### 例 3：

实 $n$ 阶矩阵的相似关系是等价关系

##### 例 4：

设 $f: X \to Y$，则 $ker(f)$ 是等价关系，其中：
$$
ker(f) = \{(x, y) | x, y \in X 并且 f(x) = f(y)\}
$$



##### 等价类的定义

设 $\cong$ 是集合 $X$ 上的一个等价关系，$x \in X$，$X$ 的子集 $E_x = \{y | y \in X, y \cong x\}$ 称为 $x$ 关于 $\cong$ 所在的等价类。记为 $[x]$，即 $[x] = \{y | y \in x , y \cong x\}$

##### 命题

$x' \in [x] \iff [x'] = [x]$

`定义`：设 $X$ 是非空集合，$X$ 的一些非空子集构成的集族  $\mathscr{A}$ 称为 $X$ 的一个划分，如果 $\mathscr{A}$ 具有如下性质：

- 对 $\forall A, B \in \mathscr{A}$，若 $A = B$，则 $A \cap B = \phi$
- $\bigcup_{A \in \mathscr{A}} A = X$

##### 例如：

模 $2$ 同余的等价关系，$\mathscr{A} = \{[1], [8]\}$ 就是 $Z$ 的划分。

##### 定理

设 $\cong$ 是集合上的一个等价关系，则 $\cong$ 的所有等价类构成的集合是 $X$ 的一个划分。

证明：

$$
1. X = \bigcup_{x \in X}[x] \\
2. 不相交，反证法
$$



##### 定理

设 $\mathscr{A}$ 是 $X$ 的一个划分，令
$$
\cong = \bigcup_{A \in \mathscr{A}}(A \times A)
$$

则 $\cong$ 是 $X$ 上的一个等价关系并且 $\mathscr{A}$ 就是 $\cong$ 的所有等价关系类构成的集族。

##### 定理

集合 $X$ 上的一个二元关系是等价关系 $\iff$ 存在 $X$ 的一个划分 $\mathscr{A}$ 使得 $x \cong y$ 的充分必要条件是存在 $A \in \mathscr{A}$，使得 $x, y \in A$

##### 商集的定义

设 $\cong$ 是集合 $X$ 上的等价关系，由 $\cong$ 的所有等价类构成的集族称为 $X$ 的商集，记为 $X / \cong$

##### 等价闭包的定义

设 $R$ 是 $X$ 上的二元关系，$X$ 上的所有包含 $R$ 的等价关系的交称为 $R$ 的等价闭包，记为 $e(R)$.

##### 定理

设 $R$ 是 $X$ 上的一个二元关系，则：
$$
e(R) = (R \cup R^{-1})^*
$$

##### 定理

设 $R, S$ 是 $X$ 上的等价关系，则 $R \circ S$ 是等价关系的充分必要条件是：
$$
R \circ S = S \circ R
$$
