运筹学复习大纲
数学 | 笔记 | 运筹学 | 经济学
运筹学是近代应用数学的一个分支，主要是研究如何将生产、管理等事件中出现的运筹问题加以提炼，然后利用数学方法进行解决的学科。 运筹学是应用数学和形式科学的跨领域研究，利用像是统计学、数学模型和算法等方法，去寻找复杂问题中的最佳或近似最佳的解答。 运筹学经常用于解决现实生活中的复杂问题，特别是改善或优化现有系统的效率。
2019-7-10

## 线性规划及单纯形法

### 数学模型

#### 三种表达形式和标准模型

表达形式：略。

##### 标准模型

$$
\max z = \sum_{j = 1}^nc_jx_j \\
s.t.
\begin{cases}
\sum_{j = 1}^n a_{ij}x_j = b_j & (i = 1, \dots, m) \\
x_j \ge 0 & (j = 1, \dots, n)
\end{cases}
$$

需要满足：

1. 目标函数是最大值
2. 约束条件是等式
3. 右端常数项 $b > 0$
4. $\mathbf{X} \ge 0$


### 其他概念

可行解、可行域、最优解、基、非基、基变量、非基变量、基解、基可行解、可行基、凸集。

`可行解`：满足约束条件

`基`：设 $\mathbf{A}$ 为约束方程组的的 $m \times n$ 阶系数矩阵（设 $n > m$），其秩为 $m$，$\mathbf{B}$ 是矩阵 $\mathbf{A}$ 中的一个 $m \times n$ 的满秩子矩阵，称 $\mathbf{B}$ 是线性规划问题的一个基。

`凸集`：对于任何 $X_1 \in C$，$X_2 \in C$，有 $aX_1 + (1 - a)X_2 \in C(0 < a < 1)$，则称 $C$ 为凸集。

### 单纯形法

#### 求解步骤

第一步：求出线性规划的**初始基可行解**，列出初始单纯形表。

第二步：进行**最优**性检验。

第三步：从一个基可行解转换到另一个**目标函数更大的基可行解**，列出行的单纯形表。

1. 确定换入的基的变量。
2. 确定换出基的变量。
3. 换入后，对表进行初等变换，使得表中基变量为 $1$，其他变量为 0。

第四步：重复第二、三步一直到计算终止。

#### 其他方法

还需要掌握：

- 图解法求解两个变量线性规划问题
- 人工变量法（大 $M$ 法）：目标函数加入：$-Mx_i$
- 两阶段法：先求只包含人工变量的单纯形表，目标函数总其他变量系数取 $0$，人工变量为 $-1$。如果最优解为 $0$，则有解；接着上面的单纯形表，目标函数系数征程，去掉人工变量继续求单纯形表。

### 解的判定

**唯一最优解**：单纯形表中，非基变量的检验数小于 0.

**无穷多最优解**：单纯形表中，存在一个非基变量的检验数等于 0.

**无界解**：目标函数最大化（最小化），在单纯形表中，若检验数大于（小于）0，但是该列所有技术系数均小于（大于）0，则判定无界解。

**无解**：大 $M$ 法或者两阶段法中还有人工变量。

### 单纯形法计算的向量矩阵描述

将原系数矩阵 $A$ 分成两个部分，计算迭代后，新单纯新表中的基，在初始单纯新表中用 $\mathbf{B}$ 表示，剩下的用 $\mathbf{N}$ 表示。
$$
\begin{array}{cccc}
初始解 & 非基变量 & 非基变量 & 基变量 \\
\hline\
\mathbf{b} & \mathbf{B} & \mathbf{N} & \mathbf{I} \\
c_j - z_j & \sigma_N & \sigma_N & 0, \dots, 0
\end{array}
$$
单纯形法的迭代计算实际上是对约束方程的系数矩阵试行初等变化。
$$
\begin{array}{cccc}
初始解 & 基变量 & 非基变量 & 非基变量 \\
\hline\
\mathbf{b'} & \mathbf{I} & \mathbf{N'} & \mathbf{B^{-1}} \\
c_j - z_j & 0, \dots, 0 & \sigma_N' & -y_1,\dots,-y_m
\end{array}
$$
显然有：

1. $\mathbf{b}' = \mathbf{B}^{-1}\mathbf{b}$
2. $\mathbf{N}' = \mathbf{B}^{-1}\mathbf{N}$ 或者 $\mathbf{P}_j' = \mathbf{B}^{-1}\mathbf{P}_j$
3. $-\mathbf{Y}^T = (-y_1, \dots, -y_m) = 0 - \mathbf{CB}^{-1} = -\mathbf{CB}^{-1}$ 
4. $z = \mathbf{CB}^{-1}\mathbf{b}$
5. $\sigma = \mathbf{C} - \mathbf{CB}^{-1}\mathbf{A} = \mathbf{C} - \mathbf{Y}^T\mathbf{P}_j$

## 线性规划的对偶理论

对偶模型的经济学含义。

根据不同的线性规划化模型给出对偶模型。（略）

注意 max 问题的 X 约束到 min 问题的条件约束不等号不变向。

### 对偶理论的七个性质

对称性；弱对偶性（$\sum c\bar{x} \le \sum b \bar{y}$）；最优性（相等可行解为最优解）；无界性（无界解 —— 无可行解）；强对偶性（又叫对偶定理，原问题有最优解，对偶问题一定有最优解）；



互补松弛性：

- 如果 $\hat{y} > 0$，则 $\sum a\hat{x} = b$；
- 如果 $\hat{y} = 0$，则 $\sum a\hat{x} < b$；



检验数和对偶问题最优解的关系：

引入松弛变量后，在初始单纯形表中，初始基可行解的基变量，在最终的单纯形表中的检验数的相反数，为对偶问题的最优解。

即松弛问题的检验数的相反数为对偶问题的最优解。

在 1.5 中，用向量矩阵描述，基变量的检验数为 $-y_1, \dots, -y_m$.

### 对偶单纯形法

标准模型上的区别：其他不变，唯独 $b \le 0$；（注意松弛变量的技术系数为正）



解法与单纯形法的区别：

2. 确定换出基的变量，最小的 $b$（即绝对值最大的 $b$）
3. 确定换入基的变量，取最小 $(c - z)/a$，满足 $a < 0, \; (c - z) < 0$ （$c - z = C - CB^{-1}A$）
4. 若 $a > 0$，则对偶问题无界，原问题无可行解

### 影子价格

$y_i$ 表示第 $i$ 种**资源增加一个单位**给目标函数带来的增加值，称其为影子价格。

影子是一种**边际价格**，在式中将 $z$ 对 $b_i$ 求偏导得：
$$
\frac{\partial z}{\partial b_i} = y_i.
$$
资源的影子价格是一种**机会成本**，反映了为增加一个单位额外资源原意付出的最大费用。

由**互补松弛性定理**可知，有 $\sum a\hat{x} < b$，$\hat{y} = 0$ 这表明生产过程中资源 $b$ 没有得到充分利用，影子价格为 0；同理当影子价格为 0，则已经充分利用，取等号。

**检验数** $\sigma = c - \sum ay$，其中 $\sum ay$ 就是各项资源的影子价格的总和，即产品的机会成本，如果产品产值 > 机会成本就生产，这也是检验数 $\sigma$ 的经济意义。

一般讲：对线性规划问题的求解是确定资源的最优分配方案，而对偶问题则是确定对**资源的恰当估价**。

### 灵敏度分析

#### 目标函数系数

线性规划目标函数：
$$
\max z = (c_1 + \lambda_1)x_1 + (c_2 + \lambda_2)x_2
$$
分别另其他 $\lambda = 0$，将一个 $\lambda$ 代入单纯形表中，根据检验数求出 $\lambda$ 的变法范围

#### 约束条件

约束条件更改：
$$
s.t.
\begin{cases}
ax \le b_1 + \lambda_1 \\
ax \le b_2 + \lambda_2 \\
ax \le b_3 + \lambda_3
\end{cases}
$$
单独分析每一个 $\lambda$：

令变化的约束条件为 $\Delta b = [\lambda_1, 0, 0]^T$，则变化后的约束条件：$b + \Delta b$

矩阵变换后的约束条件：$b' + \Delta b' = \mathbf{B}^{-1}b + \mathbf{B}^{-1}\Delta b$

使问题最优解不变的条件是：
$$
b' + \Delta b' \ge 0
$$
同理分析其他 $\lambda$

#### 增加一个变量

令增加的变量的技术系数为 $\mathbf{P}_j$.

首先计算：$\mathbf{P}_j' = \mathbf{B}^{-1}\mathbf{P}_j$；

若检验数 $\sigma < 0$  则直接放入单纯形表中，最优质不变；若检验数 $\sigma > 0$，则继续按照单纯形法迭代。

#### 增加一个约束条件

首先关注最优解是否满足新的约束条件，满足，则最优解不变。

不满足：

1. 则把新的约束条件加上松弛变量放入单纯形表中；
2. 调整单纯形表使之前的基变量系数保持为 1，新加入一行中的系数为 0；
3. 调整后的约束条件 $b < 0$，用对偶单纯形法继续迭代。
4. 得到结果或者无解。



### 参数线性规划

目标函数：
$$
\max z(\lambda) = (c_1 + \lambda)x_1 + (c_2 + \lambda)x_2
$$
先令 $\lambda = 0$ 求最终单纯形表。

将参数代入单纯形表，设定 $\lambda$ 的范围，根据检验数进行迭代，求得新最优解与 $\lambda$ 的关系。

## 运输问题

### 特点

总供给与总需求平衡：
$$
\sum a_i = \sum b_j
$$
矩阵 A 的特殊结构，包含 $m \times n$ 个变量，$m + n$ 个约束条件，但是由于上述**总供给与总需求平衡** ，所以独立列向量最大个数为 $(m + n - 1)$



解的特性：整数、一定存在可行解和最优解、$m + n - 1$ 个基变量

### 表上作业法

初始方案的给定

1. 最小元素法：注意，选择一个最小元素后，如果需要同时划去一行或者一列，为了使调运方案中有数字的格仍为 $m + n - 1$ ，需要用一个 0 填补位置。
2. 沃格尔（Vogel）法：从运价表上分别找出**每行与每列的最小的两个元素之差**，再从差值最大的行或者列找出最小运价。



最优性检验与方案的调整：

1. 闭回路法：找空格的闭回路，检验数都小于零则调整，否则最优
2. 位势法：价格 - 位势，其值与闭回路法检验数相同，调整方案方式相同。

### 产销不平衡

一般产 > 销：假想库存（运费为 0）



销售点有最低最高需求：

1. 先转换掉「最高需求不限」的销售点；
2. 假想产地为最高需求之和 - 最低需求之和；
3. 原一个销地分解为两个销地甲、乙，甲销量为最低需求，假想地乙的销量 = 最高需求 - 最低需求；
4. 价格设定：假想产地不能向甲销售点运输，所以运费为 M（无穷大），因为高于最低需求部分给不给都行，所以假想产地向乙销售点的运输费用为 0



转运问题假定：

1. 产地可以发往产地一起运
2. 可以先发往 A 销地再转给 B 销地
3. 除了产地和销地还有中转站

做法：

1. 产地、销地、中转站既作为产地也作为销地；
2. 设总产量 = P
3. 由于物资不会去一个地方两次以上，新增产地 = 新增销地 = 中转站的货物量 = P
4. 原产地产量 = 原值 + P，原销地销量 = 原值 + P

## 整数规划

### 特点和与松弛问题之间的关系

特点：

1. 不一定在松弛问题可行域的顶点上得到。
2. 松弛问题的最优解的相邻整数解不一定是整数规划的最优解。
3. 通过枚举法求解不可取。



与松弛问题之间的关系：

1. 整数规划的可行域 < 松弛问题的可行域。
2. 松弛问题的最优解可以作为**上界**。
3. 整数可行解的目标函数值可以作为**下界**。
4. 若松弛问题的可行解为整数解，则必为整数规划的最优解

### 分枝定界法

第一步：寻找替代问题并求解。替代问题的要求：

1. 容易求解
2. 替代问题解集 > 原问题

替代问题的最优解是原问题的可行解时，这个解就是原问题的最优解；否则是原问题的上界（求极大）或者下界（求极小）

显然，**松弛问题可以当作线性规划问题替代问题。**



第二步：分枝与定界。替代问题分成若干子问题，子问题也要容易求解。

1. 对于整数规划来说，将父问题的结果中，不是整数的解 $\overline{x}_i$ 取出，然后分为 $x_i <= \lfloor \overline{x}_i \rfloor$ 和 $x_i >= \lceil \overline{x}_i \rceil$ 两个子问题；
2. 对子问题求解，若子问题中有整数解，则为原问题的**可行解**，否则为**边界**；
3. 若两个都不是整数解，选择最优边界的可行域，再进行分枝与定界。
4. 一直分枝，直到找到整数解。



第三步：剪枝。选择最优整数解，剪去**劣于整数解的边界**。如果除了最优整数解外的分枝都被剪去，那么这个最优整数解就是原问题的最优整数解。否则，进入第二步继续分枝。



举例：以下为分枝过程，求解线性规划的步骤略去，*(x, y) = z* 表示在 *(x, y)* 处取得的最优值为 *z*：
$$
(3.25, 2.5) = 14.75
\begin{cases}
y < 3 \to (3.5, 2) = 14.5
\begin{cases}
x < 3 \to (3, 2) = 13 \\
x > 3 \to (4, 1) = 14
\end{cases}\\
y > 3 \to (2.5, 3) = 13.5
\end{cases}
$$


步骤：

1. 先对于 y = 2.5 进行分枝，然后发现都不是整数解，选择最优边界进行分枝
2. 对 x = 3.5 进行分枝，得到整数解，选择最优整数解 14，比较分枝，发现 y > 3 分枝的边界值劣于 14，剪去
3. 无其他分枝，则 14 为原问题最优解

### 0 - 1 规划的建模

$m$ 个约束条件中只有 $k$ 个起作用：

约束条件右端项改为 $b_i + My_i$，$M$ 是个无穷大数，然后加上约束 $\sum y = m - k$



约束条件右端值可能是多个 $b$ 中的一个：

右端项改为 $b_iy_i$，增加约束条件：$\sum y = 1$



几组条件中满足其中一组：

同理，类似于第一种情况，对于第 $j$ 组，$< b$ 改为 $< b + My_j$，$> b$ 改为 $> b - My_j$，$\sum y = 1$



表示固定费用的函数，有以下费用函数：
$$
C_i = 
\begin{cases}
K_i + c_i x_i & (x_i > 0) \\
0 & (x = 0)
\end{cases}
$$
从而增加如下约束条件，$x_i \le My_i$ 和 $y = 0$  或  $1$，并且目标函数改为 $\sum (cx + Ky)$，可以看出，要使目标函数最小，则当 $x = 0$ 时，$y = 0$

###  分配问题与匈牙利法

特殊的整数规划模型，$m$ 个任务分配给 $m$ 个人去做，求最小总时间。现有矩阵 $A$，$A_{ij}$ 表示第 $i$ 个人，做第 $j$ 个任务的时间。

#### 匈牙利法

步骤：

1. 每行减去每行最小元素值，每列减去每列最小元素值
2. 用**最少的划线**覆盖所有的零，如果矩阵比较大，不能一眼看出，可以进行如下操作：
    1. 先一行一行看，如果一行有且只有一个零（划去的不算），划去有零的那**一列**，然后按列看，划去行
    2. 若还有零，在未划去的零之间画出闭回路，每隔一个零，划去改零所在行（列）
3. 检查最少划线数是否等于行数，是，则解为当前一个全零组合。否，则进行第 4 步
4. 找出未被划去的元素中的最小值 $\min$，未被覆盖的点 - $\min$，同时被行列线覆盖的元素 + $\min$，回到第 2 步



其他问题：

1. 如果人数和任务**数量不等**，同运输的产销不平衡做法相同，设立假象任务或者人，花费为 0.
2. 一个人能完成多余一个任务
3. 若求**花费最大**，等价于负矩阵最小，然后每行每列分别加上一个值，使元素都 $\ge 0$ ，就可以用匈牙利方法进行求解了。

## 目标规划

### 模型的组成和结构

弹性约束和刚性约束：

刚性：同一般的线性规划约束没有什么不同 $\sum ax \le b$

弹性约束：

设允许出现的负偏差为 $d^-$，允许出现的正偏差为 $d^+$。正偏差和负偏差不会同时出现，所以总有：
$$
\sum ax - d^+ + d^- = b
$$


三种情况：

1. 尽量不大于，即正偏差尽量小，所以目标函数：$\min\{d^+\}$
2. 尽量不小于，目标函数：$\min\{d^-\}$
3. 尽量等于，目标函数：$\min\{d^+ + d^-\}$



优先级与权系数：

规定一个优先因子，$P_i$，并且 $P_k >> P_{k + 1}$；

对于同一个优先级的不同目标，按照重要程度可以乘上不同的系数，比如在第 i 优先级中， 3 相等的重要性是 4 的 5 倍：$\min z = 5P_i(d_3^+ + d_3^-) + P_i(d_4^+ + d_4^-)$



目标规划是寻找满意解，而线性规划是寻找最优解。

### 求解方法

图解法：

1. 先根据刚性约束做好可行域；
2. 按照优先级和重要性画出弹性约束直线，根据正负偏差的要求选择直线上、左、右；
3. 去掉不能满足的弹性约束条件
4. 最后得出偏差最小的解



单纯形法：

目标函数一定是求偏差最小，为了方便久不转换成极大。

单纯形法求解步骤：

1. 目标函数只和偏差值有关，所以目标函数矩阵 $C$ 要么是 0，要么是优先级 $P_i$，那么检验值是 $P_i$ 的线性组合，不同优先级 $P$ 值差距很大，并且需要一个一个**从高到低考虑优先级**，所以检验值设立 $k$ 行（$k$ 为优先级数），第 $i$ 行 $j$ 列表示第 $j$ 个偏差值的检验数是多少倍 $P_j$
2. 开始求解：首先观察第一个优先级的检验数，因为我们求极小，并不是标准线性规划模型，所以找**最小的负值**（如果全部非负则这一个优先级没有优化空间），同样和标准线性规划模型一样，找到最小 $b / a$ ，满足 $a, b > 0$，这样就找到换出和换入变量，进行迭代运算。
3. 当这行检验数都非负，转到下一行。对于第 $i$ 行 $(i \not = 1)$，如果这行有一个负检验数，只有当 $1 \ldots i - 1$ 行的检验数**全都是非正时**，才拿来进行迭代。

## 图与网络分析

图论相关知识传送门至离散数学：[离散数学 5 - 图论](blog.php?id=28)

复习一下有些忘了的概念：

度（有些教材叫「次」）；

边不同叫「链」，点不同叫「路」，起点终点相同的链叫「圈」，相同的路叫「回路」；

子图点集也是子集，部分图点集与原图相同；



树的性质：

前五条省略；

6. 点数大于 3，不相邻点之间加边构成唯一回路
7. 点数不小于 2，必有两个悬挂点



最小生成树（有的教材叫「最小支撑树」），Kruskal 和 Prim 都是避圈法，破圈法效率低。

dijkstra 算法略。



网络流：用人手模拟增广路的办法，宽搜的时候每条边都当成双向边，增广注意流量加减。



中国邮递员问题：

1. 是否有欧拉回路，有则欧拉回路为问题的解
2. 否，则在度为奇数的点间建立完全图（边为最短路径），选择最短边使每个点的度数都为偶数。

## 计划评审技术和关键路线法

本章主要是 PERT 网络图，画图细则略。

重点是 PERT 图的时间参数的计算。（优化可能会考）

### 计算 PERT 图的时间参数

一共 8 个时间参数：作业时间 t，最早开始时间 ES，最早结束时间 EF，最迟开始时间 LS，最迟结束时间 LF，总时差 R，自由时差 F



两个「最早」参数很好理解。

作业最早开始时间是**紧前作业全部完成**的时间，等于它的紧前作业的最早结束时间 EF 中的最大值

最早结束 = 最早开始 + 作业时间。$EF = \max ES + t$



两个「最迟」同理。

不能耽误**整个工期**，作业最迟结束时间是紧后作业总最迟开始时间中的最小值（没有紧后作业的作业的最迟结束为整个工期的时间）

最迟开始 = 最迟结束 - 作业时间。$LS = \min LF - t$



总时差：对于一个作业，为了**不影响总工期**（即这个作业开始的时间不能晚于最迟开始时间），所以总时差为最早开始和最迟开始之差。$R = LS - ES$

自由时差：为了**不影响紧后作业的开始时间**，所以不能晚于紧后作业的最早开始时间的最小值。$F = \min ES - EF$

### 关键路线和网络计划的优化

关键路线的意义：

1. 这条路的时间决定了整个工期的完成最少时间
2. 关键路上的各项作业对影响计划进度起关键作用，使整个工程的控制性环节。



题目一般会给出每一项作业的「计划完成时间」，「最短完成时间」，「缩短单位时间所需要的花费」，问总工期缩短 $t$ 所花费的最少。

优化步骤如下：

1. 找到关键路线，以及关键路线中减少单位时间花费最小的作业
2. 减少时间 = $\min\{$ 此作业最多缩短时间，自由时差，要求减少量 $\}$，优化 PERT 图
3. 是否达到要求的工期，否，回到步骤一。

## 动态规划

### 基本概念

阶段、状态、决策、策略和子策略、状态转移率、指标函数。

状态：前面各阶段状态和决策的结局，又是本阶段作出决策的出发点和依据。

决策：$x_k(s_k) \in D_k(s_k)$

### 最优化原理与数学模型

最优化原理：作为整个过程的最优策略具有这样的性质，无论过去的状态和决策如何，对先前决策所形成的状态而言，余下的诸决策必构成最优策略。

根据这个原理写出的**动态规划基本方程**（相乘也同理）：

当 $V_{k, n} = \sum_{i = k}^{n} v_i(s_i, x_i)$ 时，有
$$
f_k(s_k) = \text{opt}_{x_k \in D_k(s_k)} \{v_k(s_k, x_k) + f_{k + 1}(s_{k + 1})\}
$$
除了基本方程还有**边界条件**。



需要注意：

1. 状态变量反映演变特征，具有无后效性。
2. 决策变量可能是多维变量，取值可能离散，可能连续。

### 用动态规划方法求解非线性规划问题

比如：
$$
\max z = 12x_1 + 3x_1^2 - 2x_1^3 + 12x_2 - x_2^3\\
s.t. \begin{cases}
x_1 + x_2 \le 3 \\
x1, x2 \ge 0
\end{cases}
$$
可以把确定 $x$ 的值看作是两个阶段的决策（$k = 1, 2$），状态变量 $R$，分别为 $R_1 = 3, R_2 = 3 - x_1, R_3 = R_2 - x_2$。按照一般的动态规划过程求解即可。